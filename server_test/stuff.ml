let requests_and_responses = [
  "\002\000\000\000\000\000\000\000\000\000\000\000\001\000\000\000\000",
  "\024\000\000\000\000\000\000\000\000\000\000\000\007\000\000\000EINVAL\000";

  "\013\000\000\000\000\000\000\000\000\000\000\000\001\000\000\000\000",
  "\024\000\000\000\000\000\000\000\000\000\000\000\007\000\000\000EINVAL\000";

  "\012\000\000\000\000\000\000\000\000\000\000\000\001\000\000\000\000",
  "\012\000\000\000\000\000\000\000\000\000\000\000\024\000\000\000/local/domain/0\000";
(*
write(3, "\1\0\0\0\0\0\0\0\0\0\0\0\1\0\0\0\0", 17) = 17
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\f\0\0\0\0\0\0\0\0\0\0\0\1\0\0\0\0", 17) = 17
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\3\0\0\0\0\0\0\0\0\0\0\0\1\0\0\0\0", 17) = 17
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\16\0\0\0\0\0\0\0\0\0\0\0\1\0\0\0\0", 17) = 17
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\v\0\0\0\0\0\0\0\0\0\0\0\22\0\0\0/test\0xxx\0yyy\0\0zzz", 34) = 34
read(3, "\v\0\0\0\0\0\0\0\0\0\0\0\3\0\0\0", 16) = 16
read(3, "OK\0", 3)                      = 3
write(3, "\2\0\0\0\0\0\0\0\0\0\0\0\5\0\0\0/test", 21) = 21
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\2\0\0\0\0\0\0\0\0\0\0\0\6\0\0\0/test\0", 22) = 22
read(3, "\2\0\0\0\0\0\0\0\0\0\0\0\f\0\0\0", 16) = 16
read(3, "xxx\0yyy\0\0zzz", 12)          = 12
write(3, "\2\0\0\0\0\0\0\0\0\0\0\0\24\0\0\0/test\0some\0otherargs", 36) = 36
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\1\0\0\0\0\0\0\0\0\0\0\0\22\0\0\0/test\0spurious\0abc", 34) = 34
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\1\0\0\0\0\0\0\0\0\0\0\0\16\0\0\0/test\0spurious", 30) = 30
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\3\0\0\0\0\0\0\0\0\0\0\0\23\0\0\0/test\0someotherargs", 35) = 35
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\3\0\0\0\0\0\0\0\0\0\0\0\32\0\0\0/test\0someotherargs\0others", 42) = 42
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\v\0\0\0\0\0\0\0\0\0\0\0\6\0\0\0/test\0", 22) = 22
read(3, "\v\0\0\0\0\0\0\0\0\0\0\0\3\0\0\0", 16) = 16
read(3, "OK\0", 3)                      = 3
write(3, "\v\0\0\0\0\0\0\0\0\0\0\0\t\0\0\0/test\0abc", 25) = 25
read(3, "\v\0\0\0\0\0\0\0\0\0\0\0\3\0\0\0", 16) = 16
read(3, "OK\0", 3)                      = 3
write(3, "\2\0\0\0\0\0\0\0\0\0\0\0\5\0\0\0/test", 21) = 21
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\2\0\0\0\0\0\0\0\0\0\0\0\6\0\0\0/test\0", 22) = 22
read(3, "\2\0\0\0\0\0\0\0\0\0\0\0\3\0\0\0", 16) = 16
read(3, "abc", 3)                       = 3
write(3, "\2\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0/test\0\0", 23) = 23
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\v\0\0\0\0\0\0\0\0\0\0\0\5\0\0\0/test", 21) = 21
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\2\0\0\0\0\0\0\0\0\0\0\0\5\0\0\0/test", 21) = 21
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\2\0\0\0\0\0\0\0\0\0\0\0\6\0\0\0/test\0", 22) = 22
read(3, "\2\0\0\0\0\0\0\0\0\0\0\0\3\0\0\0", 16) = 16
read(3, "abc", 3)                       = 3
write(3, "\2\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0/test\0\0", 23) = 23
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\v\0\0\0\0\0\0\0\0\0\0\0\2\0\0\0\0/", 18) = 18
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\1\0\0\0\0\0\0\0\0\0\0\0\5\0\0\0/test", 21) = 21
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\1\0\0\0\0\0\0\0\0\0\0\0\6\0\0\0/test\0", 22) = 22
read(3, "\1\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0", 16) = 16
write(3, "\1\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0/test\0\0", 23) = 23
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\r\0\0\0\0\0\0\0\0\0\0\0\5\0\0\0/test", 21) = 21
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\1\0\0\0\0\0\0\0\0\0\0\0\5\0\0\0/test", 21) = 21
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\1\0\0\0\0\0\0\0\0\0\0\0\6\0\0\0/test\0", 22) = 22
read(3, "\1\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0", 16) = 16
write(3, "\1\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0/test\0\0", 23) = 23
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\v\0\0\0\0\0\0\0\0\0\0\0\f\0\0\0/test/abc\0x1", 28) = 28
read(3, "\v\0\0\0\0\0\0\0\0\0\0\0\3\0\0\0", 16) = 16
read(3, "OK\0", 3)                      = 3
write(3, "\v\0\0\0\0\0\0\0\0\0\0\0\f\0\0\0/test/def\0x2", 28) = 28
read(3, "\v\0\0\0\0\0\0\0\0\0\0\0\3\0\0\0", 16) = 16
read(3, "OK\0", 3)                      = 3
write(3, "\v\0\0\0\0\0\0\0\0\0\0\0\f\0\0\0/test/xyz\0x3", 28) = 28
read(3, "\v\0\0\0\0\0\0\0\0\0\0\0\3\0\0\0", 16) = 16
read(3, "OK\0", 3)                      = 3
write(3, "\v\0\0\0\0\0\0\0\0\0\0\0\f\0\0\0/test/xyz\0x4", 28) = 28
read(3, "\v\0\0\0\0\0\0\0\0\0\0\0\3\0\0\0", 16) = 16
read(3, "OK\0", 3)                      = 3
write(3, "\1\0\0\0\0\0\0\0\0\0\0\0\5\0\0\0/test", 21) = 21
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\1\0\0\0\0\0\0\0\0\0\0\0\6\0\0\0/test\0", 22) = 22
read(3, "\1\0\0\0\0\0\0\0\0\0\0\0\f\0\0\0", 16) = 16
read(3, "abc\0def\0xyz\0", 12)          = 12
write(3, "\1\0\0\0\0\0\0\0\0\0\0\0\17\0\0\0/test\0spurious\0", 31) = 31
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\3\0\0\0\0\0\0\0\0\0\0\0\5\0\0\0/test", 21) = 21
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\3\0\0\0\0\0\0\0\0\0\0\0\6\0\0\0/test\0", 22) = 22
read(3, "\3\0\0\0\0\0\0\0\0\0\0\0\3\0\0\0", 16) = 16
read(3, "n0\0", 3)                      = 3
write(3, "\3\0\0\0\0\0\0\0\0\0\0\0\17\0\0\0/test\0spurious\0", 31) = 31
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\16\0\0\0\0\0\0\0\0\0\0\0\5\0\0\0/test", 21) = 21
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\3\0\0\0\0\0\0\0\0\0\0\0\6\0\0\0/test\0", 22) = 22
read(3, "\3\0\0\0\0\0\0\0\0\0\0\0\3\0\0\0", 16) = 16
read(3, "n0\0", 3)                      = 3
write(3, "\16\0\0\0\0\0\0\0\0\0\0\0\6\0\0\0/test\0", 22) = 22
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\3\0\0\0\0\0\0\0\0\0\0\0\6\0\0\0/test\0", 22) = 22
read(3, "\3\0\0\0\0\0\0\0\0\0\0\0\3\0\0\0", 16) = 16
read(3, "n0\0", 3)                      = 3
write(3, "\16\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0/test\0\0", 23) = 23
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\3\0\0\0\0\0\0\0\0\0\0\0\6\0\0\0/test\0", 22) = 22
read(3, "\3\0\0\0\0\0\0\0\0\0\0\0\3\0\0\0", 16) = 16
read(3, "n0\0", 3)                      = 3
write(3, "\16\0\0\0\0\0\0\0\0\0\0\0\t\0\0\0/test\0n0\0", 25) = 25
read(3, "\16\0\0\0\0\0\0\0\0\0\0\0\3\0\0\0", 16) = 16
read(3, "OK\0", 3)                      = 3
write(3, "\3\0\0\0\0\0\0\0\0\0\0\0\6\0\0\0/test\0", 22) = 22
read(3, "\3\0\0\0\0\0\0\0\0\0\0\0\3\0\0\0", 16) = 16
read(3, "n0\0", 3)                      = 3
write(3, "\16\0\0\0\0\0\0\0\0\0\0\0\10\0\0\0/test\0n0", 24) = 24
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\3\0\0\0\0\0\0\0\0\0\0\0\6\0\0\0/test\0", 22) = 22
read(3, "\3\0\0\0\0\0\0\0\0\0\0\0\3\0\0\0", 16) = 16
read(3, "n0\0", 3)                      = 3
write(3, "\16\0\0\0\0\0\0\0\0\0\0\0\v\0\0\0/test\0n0\0r1", 27) = 27
read(3, "\16\0\0\0\0\0\0\0\0\0\0\0\3\0\0\0", 16) = 16
read(3, "OK\0", 3)                      = 3
write(3, "\3\0\0\0\0\0\0\0\0\0\0\0\6\0\0\0/test\0", 22) = 22
read(3, "\3\0\0\0\0\0\0\0\0\0\0\0\3\0\0\0", 16) = 16
read(3, "n0\0", 3)                      = 3
write(3, "\16\0\0\0\0\0\0\0\0\0\0\0\f\0\0\0/test\0n0\0r1\0", 28) = 28
read(3, "\16\0\0\0\0\0\0\0\0\0\0\0\3\0\0\0", 16) = 16
read(3, "OK\0", 3)                      = 3
write(3, "\3\0\0\0\0\0\0\0\0\0\0\0\6\0\0\0/test\0", 22) = 22
read(3, "\3\0\0\0\0\0\0\0\0\0\0\0\6\0\0\0", 16) = 16
read(3, "n0\0r1\0", 6)                  = 6
write(3, "\16\0\0\0\0\0\0\0\0\0\0\0\23\0\0\0/test\0n0r2\0spurious", 35) = 35
read(3, "\20\0\0\0\0\0\0\0\0\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\3\0\0\0\0\0\0\0\0\0\0\0\6\0\0\0/test\0", 22) = 22
read(3, "\3\0\0\0\0\0\0\0\0\0\0\0\6\0\0\0", 16) = 16
read(3, "n0\0r1\0", 6)                  = 6
write(3, "\6\0\0\0\0\0\0\0\0\0\0\0\1\0\0\0\0", 17) = 17
read(3, "\6\0\0\0\0\0\0\0\0\0\0\0\2\0\0\0", 16) = 16
read(3, "1\0", 2)                       = 2
write(3, "\7\0\0\0\0\0\0\0\1\0\0\0\1\0\0\0\0", 17) = 17
read(3, "\20\0\0\0\0\0\0\0\1\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\6\0\0\0\0\0\0\0\0\0\0\0\1\0\0\0\0", 17) = 17
read(3, "\6\0\0\0\0\0\0\0\0\0\0\0\2\0\0\0", 16) = 16
read(3, "2\0", 2)                       = 2
write(3, "\7\0\0\0\0\0\0\0\2\0\0\0\2\0\0\0002\0", 18) = 18
read(3, "\20\0\0\0\0\0\0\0\2\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
write(3, "\6\0\0\0\0\0\0\0\0\0\0\0\2\0\0\0\0\0", 18) = 18
read(3, "\6\0\0\0\0\0\0\0\0\0\0\0\2\0\0\0", 16) = 16
read(3, "3\0", 2)                       = 2
write(3, "\7\0\0\0\0\0\0\0\3\0\0\0\3\0\0\0000\0\0", 19) = 19
read(3, "\20\0\0\0\0\0\0\0\3\0\0\0\7\0\0\0", 16) = 16
read(3, "EINVAL\0", 7)                  = 7
*)

module FakeServer = struct

end

module Server = Xenstore_server.Xs_server.Server(FakeServer)
